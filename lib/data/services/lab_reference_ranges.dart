/// 검사 항목별 기준치 (Reference Ranges) 제공 유틸리티
/// 
/// 강아지와 고양이의 검사 항목별 정상 기준치를 제공합니다.
/// DRY 원칙 준수를 위해 단일 진실의 원천(Single Source of Truth)으로 사용됩니다.
class LabReferenceRanges {
  LabReferenceRanges._(); // Private constructor to prevent instantiation

  /// 강아지 기준치 맵
  static Map<String, String> get dogRanges => Map.unmodifiable(_dogRanges);

  /// 고양이 기준치 맵
  static Map<String, String> get catRanges => Map.unmodifiable(_catRanges);

  /// 펫 종류에 따라 적절한 기준치를 반환합니다.
  /// 
  /// [species] 펫 종류 ('dog', 'cat' 등)
  /// [testItem] 검사 항목명
  /// 
  /// Returns 펫 종류에 맞는 기준치, 없으면 빈 문자열
  static String getReference(String species, String testItem) {
    final isCat = species.toLowerCase() == 'cat';
    if (isCat) {
      return _catRanges[testItem] ?? _dogRanges[testItem] ?? '';
    }
    return _dogRanges[testItem] ?? _catRanges[testItem] ?? '';
  }

  /// 모든 검사 항목 키 목록을 반환합니다 (강아지 + 고양이 통합)
  ///
  /// Returns 중복 제거된 검사 항목 키 목록
  static List<String> getAllTestKeys() {
    final keys = <String>{};
    keys.addAll(_dogRanges.keys);
    keys.addAll(_catRanges.keys);
    return keys.toList();
  }

  /// 검사 항목의 한국어 설명을 반환합니다.
  ///
  /// [testItem] 검사 항목명
  ///
  /// Returns 해당 항목의 설명, 없으면 빈 문자열
  static String getDescription(String testItem) {
    return _descriptions[testItem] ?? '';
  }

  /// 강아지 기준치 (ABC 순)
  static final Map<String, String> _dogRanges = {
    'ALB': '2.6~4.0', // 알부민
    'ALP': '20~150',
    'ALT GPT': '10~100',
    'AST GOT': '15~66',
    'BUN': '9.2~29.2',
    'Ca': '9.0~12.0',
    'CK': '59~895', // 크레아틴 키나아제
    'Cl': '106~120',
    'CREA': '0.5~1.6', // 크레아티닌
    'GGT': '0~13', // 감마글루타밀전이효소
    'GLU': '65~118',
    'K': '3.6~5.5',
    'LIPA': '100~750',
    'Na': '140~155',
    'NH3': '16~90',
    'PHOS': '2.5~6.8',
    'TBIL': '0.1~0.6',
    'T-CHOL': '110~320',
    'TG': '20~150', // 중성지방
    'TPRO': '5.4~7.8', // 총단백
    'Na/K': '27~38',
    'ALB/GLB': '0.8~1.5',
    'BUN/CRE': '10~27',
    'GLOB': '2.0~4.5',
    'vAMY-P': '500~1500',
    'SDMA': '~14',
    'HCT': '37~55',
    'HGB': '12~18',
    'MCH': '19~23',
    'MCHC': '32~36',
    'MCV': '60~77',
    'MPV': '7~12',
    'PLT': '200~500',
    'RBC': '5.5~8.5',
    'RDW-CV': '14~18',
    'WBC': '6~17',
    'WBC-GRAN(#)': '4~12',
    'WBC-GRAN(%)': '0~100',
    'WBC-LYM(#)': '1~4.8',
    'WBC-LYM(%)': '0~100',
    'WBC-MONO(#)': '0~1.3',
    'WBC-MONO(%)': '0~100',
    'WBC-EOS(#)': '0~1.2',
    'WBC-EOS(%)': '0~100',
  };

  /// 고양이 기준치 (ABC 순)
  static final Map<String, String> _catRanges = {
    'ALB': '2.3~3.5', // 알부민
    'ALP': '9~53',
    'ALT GPT': '20~120',
    'AST GOT': '18~51',
    'BUN': '17.6~32.8',
    'Ca': '8.8~11.9',
    'CK': '87~309', // 크레아틴 키나아제
    'Cl': '107~120',
    'CREA': '0.8~1.8', // Creatinine
    'GGT': '1~10', // 글로불린
    'GLU': '71~148',
    'K': '3.4~4.6',
    'LIPA': '0~30',
    'Na': '147~156',
    'NH3': '23~78',
    'PHOS': '2.6~6.0',
    'TBIL': '0.1~0.4',
    'T-CHOL': '89~176',
    'TG': '17~104', // 총빌리루빈
    'TPRO': '5.7~7.8', // 중성지방
    'Na/K': '33.6~44.2', // 총단백
    'ALB/GLB': '0.4~1.1',
    'BUN/CRE': '17.5~21.9',
    'GLOB': '2.7~5.2',
    'vAMY-P': '200~1900',
    'SDMA': '~14',
    'HCT': '27~47',
    'HGB': '8~17',
    'MCH': '13~17',
    'MCHC': '31~36',
    'MCV': '40~55',
    'MPV': '6.5~15',
    'PLT': '180~430',
    'RBC': '5~10',
    'RDW-CV': '17~22',
    'WBC': '5~11',
    'WBC-GRAN(#)': '3~12',
    'WBC-GRAN(%)': '0~100',
    'WBC-LYM(#)': '1~4',
    'WBC-LYM(%)': '0~100',
    'WBC-MONO(#)': '0~0.5',
    'WBC-MONO(%)': '0~100',
    'WBC-EOS(#)': '0~0.6',
    'WBC-EOS(%)': '0~100',
  };

  /// 검사 항목별 한국어 설명
  static const Map<String, String> _descriptions = {
    // 생화학 검사
    'ALB': '알부민. 간에서 만들어지는 단백질로, 영양 상태와 간 기능을 반영합니다. 낮으면 간질환, 신장질환, 영양실조를 의심할 수 있습니다.',
    'ALP': '알칼리성 인산분해효소. 간, 뼈, 담도 관련 효소로, 높으면 간담도 질환이나 골질환을 의심할 수 있습니다.',
    'ALT GPT': '알라닌 아미노전이효소. 주로 간세포에 존재하며, 수치가 높으면 간세포 손상을 의미합니다.',
    'AST GOT': '아스파르테이트 아미노전이효소. 간, 심장, 근육에 존재하며, 높으면 간 또는 근육 손상을 의심할 수 있습니다.',
    'BUN': '혈액요소질소. 신장 기능을 평가하는 지표로, 높으면 신장 기능 저하나 탈수를 의심할 수 있습니다.',
    'Ca': '칼슘. 뼈 건강, 근육 수축, 신경 전달에 중요한 미네랄입니다. 비정상 수치는 부갑상선 질환 등을 의심할 수 있습니다.',
    'CK': '크레아틴 키나아제. 근육 손상 시 혈중 농도가 증가하는 효소입니다.',
    'Cl': '염소. 체액 균형과 산-염기 균형 유지에 중요한 전해질입니다.',
    'CREA': '크레아티닌. 신장 기능을 평가하는 핵심 지표로, 높으면 신장 기능 저하를 의미합니다.',
    'GGT': '감마글루타밀전이효소. 담도계 질환에 민감한 효소로, 높으면 담즙 정체나 간질환을 의심할 수 있습니다.',
    'GLU': '혈당(포도당). 당뇨병 진단과 모니터링에 중요한 지표입니다.',
    'K': '칼륨. 심장 기능과 근육 수축에 필수적인 전해질입니다. 비정상 수치는 심장에 영향을 줄 수 있습니다.',
    'LIPA': '리파아제. 췌장에서 분비되는 효소로, 높으면 췌장염을 의심할 수 있습니다.',
    'Na': '나트륨. 체액 균형 조절에 핵심적인 전해질입니다.',
    'NH3': '암모니아. 간에서 처리되는 독성 물질로, 높으면 간 기능 장애를 의미합니다.',
    'PHOS': '인. 뼈와 치아 형성에 중요하며, 신장 기능 평가에도 사용됩니다.',
    'TBIL': '총 빌리루빈. 적혈구 분해 산물로, 높으면 간질환이나 담도 폐쇄, 용혈성 질환을 의심할 수 있습니다.',
    'T-CHOL': '총 콜레스테롤. 지질 대사를 평가하는 지표로, 높으면 갑상선 기능 저하 등을 의심할 수 있습니다.',
    'TG': '중성지방. 지질 대사 상태를 반영하며, 높으면 췌장염 위험이 증가할 수 있습니다.',
    'TPRO': '총 단백질. 알부민과 글로불린의 합으로, 전반적인 영양 및 면역 상태를 반영합니다.',
    'Na/K': '나트륨/칼륨 비율. 부신 기능 평가에 사용되며, 낮으면 애디슨병을 의심할 수 있습니다.',
    'ALB/GLB': '알부민/글로불린 비율. 간 기능과 면역 상태를 종합적으로 평가하는 지표입니다.',
    'BUN/CRE': 'BUN/크레아티닌 비율. 신장 질환의 원인을 감별하는 데 도움이 됩니다.',
    'GLOB': '글로불린. 면역 기능과 관련된 단백질로, 높으면 만성 염증이나 감염을 의심할 수 있습니다.',
    'vAMY-P': '췌장 아밀라아제. 췌장 기능을 평가하며, 높으면 췌장염을 의심할 수 있습니다.',
    'SDMA': '대칭 디메틸아르기닌. 초기 신장 질환을 감지하는 민감한 지표로, CREA보다 일찍 변화합니다.',
    // CBC (전혈구 검사)
    'HCT': '적혈구 용적률. 혈액 중 적혈구가 차지하는 비율로, 빈혈이나 탈수 여부를 확인합니다.',
    'HGB': '헤모글로빈. 산소를 운반하는 적혈구 내 단백질로, 빈혈 진단에 중요합니다.',
    'MCH': '평균 적혈구 혈색소량. 적혈구 하나에 포함된 헤모글로빈의 평균량입니다.',
    'MCHC': '평균 적혈구 혈색소 농도. 적혈구 내 헤모글로빈 농도로, 빈혈 유형 분류에 사용됩니다.',
    'MCV': '평균 적혈구 용적. 적혈구의 평균 크기로, 빈혈의 원인을 감별하는 데 도움이 됩니다.',
    'MPV': '평균 혈소판 용적. 혈소판의 평균 크기로, 골수 기능 평가에 참고됩니다.',
    'PLT': '혈소판 수. 지혈 기능에 필수적이며, 낮으면 출혈 경향, 높으면 혈전 위험이 있습니다.',
    'RBC': '적혈구 수. 산소 운반 능력을 반영하며, 낮으면 빈혈을 의미합니다.',
    'RDW-CV': '적혈구 분포폭. 적혈구 크기의 변이를 나타내며, 빈혈 감별에 사용됩니다.',
    'WBC': '백혈구 수. 면역 기능의 핵심 지표로, 높으면 감염이나 염증, 낮으면 면역 저하를 의미합니다.',
    'WBC-GRAN(#)': '과립구 절대수. 세균 감염 방어에 중요한 백혈구로, 호중구가 대부분을 차지합니다.',
    'WBC-GRAN(%)': '과립구 비율. 전체 백혈구 중 과립구가 차지하는 비율입니다.',
    'WBC-LYM(#)': '림프구 절대수. 바이러스 감염 방어와 면역 반응에 중요한 백혈구입니다.',
    'WBC-LYM(%)': '림프구 비율. 전체 백혈구 중 림프구가 차지하는 비율입니다.',
    'WBC-MONO(#)': '단핵구 절대수. 만성 염증과 면역 반응에 관여하는 백혈구입니다.',
    'WBC-MONO(%)': '단핵구 비율. 전체 백혈구 중 단핵구가 차지하는 비율입니다.',
    'WBC-EOS(#)': '호산구 절대수. 알레르기 반응과 기생충 감염 시 증가하는 백혈구입니다.',
    'WBC-EOS(%)': '호산구 비율. 전체 백혈구 중 호산구가 차지하는 비율입니다.',
  };
}

